<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Form Pengambilan Stok</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {background: #23272a; color: #fff; font-family: 'Segoe UI', Arial, sans-serif;}
    form {background: #2f3136; padding: 24px; border-radius: 8px; max-width: 420px; margin: 40px auto;}
    label {display:block; margin: 10px 0 5px;}
    input, select, textarea {width:100%; padding:8px; border-radius:5px; border:none; background:#40444b; color:#fff;}
    button {background:#5865f2; color:#fff; border:none; padding:10px 0; border-radius:5px; font-weight:bold; width:100%; margin-top:20px;}
    h2 {text-align:center;}
  </style>
</head>
<body>
  <form id="stockForm">
    <h2>Pengambilan Stok Baru</h2>
    <label for="pemohon">Pemohon</label>
    <input type="text" id="pemohon" required>
    <label for="penanggungJawab">Penanggung Jawab</label>
    <input type="text" id="penanggungJawab" required>
    <label for="pegagan">Pegagan (unit)</label>
    <input type="number" id="pegagan" min="0" value="0">
    <label for="perban">Perban (unit)</label>
    <input type="number" id="perban" min="0" value="0">
    <label for="painkiller">Painkiller (unit)</label>
    <input type="number" id="painkiller" min="0" value="0">
    <label for="betadine">Betadine (unit)</label>
    <input type="number" id="betadine" min="0" value="0">
    <label for="zatbesi">Zat Besi (unit)</label>
    <input type="number" id="zatbesi" min="0" value="0">
    <label for="sayurkol">Sayur Kol (unit)</label>
    <input type="number" id="sayurkol" min="0" value="0">
    <label for="keterangan">Keterangan</label>
    <textarea id="keterangan" rows="2"></textarea>
    <button type="submit">Kirim ke Discord</button>
  </form>
  <script>
    document.getElementById('stockForm').onsubmit = async function(e) {
      e.preventDefault();
      const pemohon = document.getElementById('pemohon').value;
      const penanggungJawab = document.getElementById('penanggungJawab').value;
      const pegagan = document.getElementById('pegagan').value;
      const perban = document.getElementById('perban').value;
      const painkiller = document.getElementById('painkiller').value;
      const betadine = document.getElementById('betadine').value;
      const zatbesi = document.getElementById('zatbesi').value;
      const sayurkol = document.getElementById('sayurkol').value;
      const keterangan = document.getElementById('keterangan').value;

      // Ambil waktu sekarang (WIB)
      const waktuSekarang = new Date();
      const waktuUTC = new Date(waktuSekarang.getTime() + (waktuSekarang.getTimezoneOffset() * 60000));
      const waktuWIB = new Date(waktuUTC.getTime() + (7 * 60 * 60 * 1000)); // UTC+7

      const hariID = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
      const bulanID = [
        "Januari","Februari","Maret","April","Mei","Juni",
        "Juli","Agustus","September","Oktober","November","Desember"
      ];
      const tanggalFormatted = `${hariID[waktuWIB.getDay()]}, ${waktuWIB.getDate()} ${bulanID[waktuWIB.getMonth()]} ${waktuWIB.getFullYear()}`;
      const jamFormatted = waktuWIB.toTimeString().slice(0,5);

      const webhookUrl = "https://discord.com/api/webhooks/1364665385374191707/nBSRNthx10Qs9qDjoTn3DMObVqueld7ywxLBnz4DdopPiozCLzRcgjpu9eLH8K_yMvFV";
      const data = {
        "embeds": [
          {
            "color": 5793266,
            "title": "üì¶ Pengambilan Stok Baru",
            "fields": [
              { "name": "Tanggal", "value": tanggalFormatted, "inline": false },
              { "name": "Pukul", "value": jamFormatted, "inline": false },
              { "name": "üë§ Pemohon", "value": pemohon, "inline": false },
              { "name": "üßë‚Äçüíº Penanggung Jawab", "value": penanggungJawab, "inline": false },
              { "name": "üìã Barang Diambil", "value": 
                  `‚Ä¢ Pegagan: ${pegagan} unit\n`+
                  `‚Ä¢ Perban: ${perban} unit\n`+
                  `‚Ä¢ Painkiller: ${painkiller} unit\n`+
                  `‚Ä¢ Betadine: ${betadine} unit\n`+
                  `‚Ä¢ Zat Besi: ${zatbesi} unit\n`+
                  `‚Ä¢ Sayur Kol: ${sayurkol} unit`, "inline": false 
              },
              { "name": "Keterangan", "value": keterangan ? keterangan : "-", "inline": false }
            ],
            "footer": { "text": `Tabib Pulau Cayo ‚Ä¢ ${jamFormatted}` }
          }
        ]
      };

      try {
        const res = await fetch(webhookUrl, {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(data)
        });
        if (res.ok) {
          alert("Berhasil dikirim ke Discord!");
          document.getElementById('stockForm').reset();
        } else {
          alert("Gagal mengirim ke Discord. Pastikan webhook benar.");
        }
      } catch (err) {
        alert("Error mengirim ke Discord.");
      }
    };
  </script>
</body>
</html>